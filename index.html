<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏±‡∏ö‡∏ä‡∏≥‡∏£‡∏∞‡∏Ñ‡πà‡∏≤‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏π‡∏õ‡πÇ‡∏†‡∏Ñ</title>
<link rel="manifest" href="manifest.json">
<meta name="apple-mobile-web-app-capable" content="yes">
<link rel="apple-touch-icon" href="icon.png">
<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&family=Prompt:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0d1117;
    --surface: #161b22;
    --surface2: #1c2230;
    --border: #30363d;
    --water: #38bdf8;
    --electric: #fbbf24;
    --rent: #a78bfa;
    --success: #4ade80;
    --danger: #f87171;
    --text: #e6edf3;
    --muted: #8b949e;
    --sidebar-w: 260px;
    --radius: 16px;
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Sarabun', sans-serif;
    min-height: 100vh;
    display: flex;
  }
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background:
      radial-gradient(ellipse 60% 40% at 20% 10%, rgba(56,189,248,0.07) 0%, transparent 70%),
      radial-gradient(ellipse 50% 35% at 80% 80%, rgba(251,191,36,0.06) 0%, transparent 70%);
    pointer-events: none;
    z-index: 0;
  }

  /* ===== SIDEBAR ===== */
  .sidebar {
    width: var(--sidebar-w);
    background: var(--surface);
    border-right: 1px solid var(--border);
    height: 100vh;
    position: fixed;
    left: 0; top: 0;
    display: flex;
    flex-direction: column;
    z-index: 50;
    transition: transform 0.3s cubic-bezier(0.4,0,0.2,1);
  }
  .sidebar.collapsed { transform: translateX(-100%); }

  .sidebar-head {
    padding: 20px 18px 14px;
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    justify-content: space-between;
  }
  .sidebar-logo {
    display: flex;
    align-items: center;
    gap: 10px;
    font-family: 'Prompt', sans-serif;
    font-size: 15px;
    font-weight: 700;
  }
  .logo-icons { display: flex; gap: 4px; }
  .logo-icons span {
    width: 28px; height: 28px;
    border-radius: 8px;
    display: flex; align-items: center; justify-content: center;
    font-size: 14px;
  }
  .logo-icons .w { background: rgba(56,189,248,0.15); }
  .logo-icons .e { background: rgba(251,191,36,0.15); }

  .sidebar-close-btn {
    background: none; border: none;
    color: var(--muted); cursor: pointer;
    font-size: 18px; padding: 4px 8px;
    border-radius: 6px;
    transition: background 0.15s;
    line-height: 1;
  }
  .sidebar-close-btn:hover { background: var(--surface2); color: var(--text); }

  .btn-add-room {
    margin: 14px 14px 10px;
    padding: 11px 14px;
    background: rgba(56,189,248,0.08);
    border: 1px dashed rgba(56,189,248,0.4);
    border-radius: 12px;
    color: var(--water);
    font-family: 'Sarabun', sans-serif;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: background 0.2s, border-color 0.2s;
  }
  .btn-add-room:hover { background: rgba(56,189,248,0.15); border-color: rgba(56,189,248,0.7); }

  .rooms-label {
    padding: 6px 18px 8px;
    font-size: 11px;
    font-weight: 600;
    color: var(--muted);
    letter-spacing: 0.08em;
    text-transform: uppercase;
  }

  .rooms-list {
    flex: 1;
    overflow-y: auto;
    padding: 0 10px 20px;
  }
  .rooms-list::-webkit-scrollbar { width: 4px; }
  .rooms-list::-webkit-scrollbar-thumb { background: var(--border); border-radius: 4px; }

  .room-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 10px 12px;
    border-radius: 10px;
    cursor: pointer;
    margin-bottom: 4px;
    transition: background 0.15s;
    border: 1px solid transparent;
  }
  .room-item:hover { background: var(--surface2); }
  .room-item.active {
    background: rgba(56,189,248,0.1);
    border-color: rgba(56,189,248,0.25);
  }
  .room-info { display: flex; flex-direction: column; gap: 2px; }
  .room-name { font-family: 'Prompt', sans-serif; font-weight: 600; font-size: 14px; }
  .room-item.active .room-name { color: var(--water); }
  .room-tenant { font-size: 12px; color: var(--muted); max-width: 150px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }

  .room-delete {
    background: none; border: none;
    color: var(--muted); cursor: pointer;
    font-size: 14px; padding: 4px 6px;
    border-radius: 6px;
    opacity: 0;
    transition: opacity 0.15s, background 0.15s, color 0.15s;
  }
  .room-item:hover .room-delete { opacity: 1; }
  .room-delete:hover { background: rgba(248,113,113,0.15); color: var(--danger); }

  .no-rooms {
    padding: 30px 14px;
    text-align: center;
    color: var(--muted);
    font-size: 13px;
    line-height: 1.8;
  }

  /* ===== TOPBAR ===== */
  .topbar {
    position: fixed;
    top: 0;
    left: var(--sidebar-w);
    right: 0;
    height: 56px;
    background: rgba(13,17,23,0.88);
    backdrop-filter: blur(8px);
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    padding: 0 24px;
    gap: 14px;
    z-index: 40;
    transition: left 0.3s;
  }
  .topbar.expanded { left: 0; }

  .btn-menu {
    background: var(--surface2);
    border: 1px solid var(--border);
    color: var(--text);
    width: 36px; height: 36px;
    border-radius: 10px;
    cursor: pointer;
    font-size: 16px;
    display: flex; align-items: center; justify-content: center;
    transition: background 0.15s;
    flex-shrink: 0;
  }
  .btn-menu:hover { background: var(--border); }

  .topbar-title {
    font-family: 'Prompt', sans-serif;
    font-size: 15px;
    font-weight: 600;
  }

  .topbar-room {
    font-size: 13px;
    color: var(--water);
    background: rgba(56,189,248,0.1);
    border: 1px solid rgba(56,189,248,0.25);
    padding: 3px 10px;
    border-radius: 20px;
  }

  /* ===== MAIN ===== */
  .main {
    margin-left: var(--sidebar-w);
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 40px 24px;
    position: relative;
    z-index: 1;
    transition: margin-left 0.3s;
  }
  .main.expanded { margin-left: 0; }

  .content { width: 100%; max-width: 680px; margin-top: 72px; }

  /* Empty state */
  .empty-state {
    text-align: center;
    padding: 80px 20px;
    animation: fadeUp 0.5s ease both;
  }
  .empty-icon { font-size: 64px; margin-bottom: 20px; opacity: 0.5; }
  .empty-state h2 { font-family: 'Prompt', sans-serif; font-size: 22px; margin-bottom: 10px; color: var(--muted); }
  .empty-state p { color: var(--muted); font-size: 15px; margin-bottom: 28px; line-height: 1.6; }
  .btn-empty {
    display: inline-flex; align-items: center; gap: 8px;
    padding: 13px 24px;
    background: linear-gradient(135deg, #38bdf8, #0ea5e9);
    color: #fff; border: none; border-radius: 12px;
    font-family: 'Prompt', sans-serif; font-size: 15px; font-weight: 600; cursor: pointer;
    box-shadow: 0 4px 20px rgba(56,189,248,0.3);
    transition: transform 0.15s, box-shadow 0.15s;
  }
  .btn-empty:hover { transform: translateY(-2px); box-shadow: 0 8px 28px rgba(56,189,248,0.4); }

  /* ===== CARDS ===== */
  .form-header {
    text-align: center;
    margin-bottom: 28px;
    animation: fadeDown 0.5s ease both;
  }
  .header-pill {
    display: inline-flex; align-items: center; gap: 10px;
    background: var(--surface); border: 1px solid var(--border);
    border-radius: 14px; padding: 10px 18px; margin-bottom: 12px;
  }
  .room-badge { font-family: 'Prompt', sans-serif; font-size: 22px; font-weight: 700; color: var(--water); }
  .form-header h1 { font-family: 'Prompt', sans-serif; font-size: 22px; font-weight: 700; margin-bottom: 4px; }
  .form-header p { color: var(--muted); font-size: 14px; }

  .card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 24px;
    margin-bottom: 16px;
    animation: fadeUp 0.5s ease both;
  }
  .card-header { display: flex; align-items: center; gap: 10px; margin-bottom: 20px; }
  .card-dot { width: 10px; height: 10px; border-radius: 50%; }
  .dot-water { background: var(--water); box-shadow: 0 0 8px rgba(56,189,248,0.6); }
  .dot-elec  { background: var(--electric); box-shadow: 0 0 8px rgba(251,191,36,0.6); }
  .dot-rent  { background: var(--rent); box-shadow: 0 0 8px rgba(167,139,250,0.6); }
  .card-title { font-family: 'Prompt', sans-serif; font-size: 15px; font-weight: 600; }

  .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; }
  .form-grid .full { grid-column: 1 / -1; }
  .form-group { display: flex; flex-direction: column; gap: 6px; }

  label { font-size: 12px; font-weight: 500; color: var(--muted); letter-spacing: 0.02em; }

  input, select {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 10px;
    color: var(--text);
    font-family: 'Sarabun', sans-serif;
    font-size: 15px;
    padding: 10px 13px;
    outline: none;
    transition: border-color 0.2s, box-shadow 0.2s;
    width: 100%;
  }
  input:focus, select:focus { border-color: var(--water); box-shadow: 0 0 0 3px rgba(56,189,248,0.12); }
  .elec-focus input:focus { border-color: var(--electric); box-shadow: 0 0 0 3px rgba(251,191,36,0.12); }
  input::placeholder { color: #4a5568; }

  .unit-display {
    display: flex; align-items: center; justify-content: space-between;
    background: var(--surface2); border: 1px solid var(--border);
    border-radius: 10px; padding: 12px 14px; margin-top: 10px;
  }
  .unit-label { color: var(--muted); font-size: 14px; }
  .unit-val { font-family: 'Prompt', sans-serif; font-weight: 600; font-size: 17px; }
  .unit-val.water { color: var(--water); }
  .unit-val.elec  { color: var(--electric); }
  .unit-val.rent  { color: var(--rent); }

  .summary-row {
    display: flex; justify-content: space-between; align-items: center;
    padding: 11px 0; border-bottom: 1px solid var(--border); font-size: 15px;
  }
  .summary-row:last-of-type { border-bottom: none; }
  .summary-row .slabel { color: var(--muted); }
  .summary-row .val { font-weight: 600; }
  .summary-row .val.water { color: var(--water); }
  .summary-row .val.elec  { color: var(--electric); }
  .summary-row .val.rent  { color: var(--rent); }

  .total-row {
    margin-top: 12px; padding: 14px;
    background: var(--surface2); border-radius: 12px;
    display: flex; justify-content: space-between; align-items: center;
  }
  .total-label { font-family: 'Prompt', sans-serif; font-size: 14px; color: var(--muted); font-weight: 600; }
  .total-amount {
    font-family: 'Prompt', sans-serif; font-size: 24px; font-weight: 700;
    background: linear-gradient(90deg, var(--water), var(--electric));
    -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
  }

  .btn {
    width: 100%; padding: 14px; border-radius: 12px; border: none;
    font-family: 'Prompt', sans-serif; font-size: 15px; font-weight: 600;
    cursor: pointer; margin-top: 16px;
    transition: transform 0.15s, box-shadow 0.15s;
    letter-spacing: 0.02em;
  }
  .btn-primary {
    background: linear-gradient(135deg, #38bdf8, #0ea5e9);
    color: #fff; box-shadow: 0 4px 20px rgba(56,189,248,0.3);
  }
  .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 28px rgba(56,189,248,0.4); }

  /* ===== OVERLAYS ===== */
  .overlay {
    display: none; position: fixed; inset: 0;
    background: rgba(0,0,0,0.7); backdrop-filter: blur(6px);
    z-index: 200; align-items: center; justify-content: center;
  }
  .overlay.show { display: flex; }

  .modal {
    background: var(--surface); border: 1px solid var(--border);
    border-radius: 20px; padding: 32px; max-width: 380px; width: 90%;
    animation: popIn 0.3s cubic-bezier(0.34,1.56,0.64,1) both;
  }
  .modal h2 { font-family: 'Prompt', sans-serif; font-size: 18px; margin-bottom: 6px; }
  .modal p { color: var(--muted); font-size: 14px; margin-bottom: 20px; }
  .modal-input {
    background: var(--surface2); border: 1px solid var(--border);
    border-radius: 10px; color: var(--text);
    font-family: 'Sarabun', sans-serif; font-size: 16px;
    padding: 12px 14px; outline: none; width: 100%; margin-bottom: 16px;
    transition: border-color 0.2s;
  }
  .modal-input:focus { border-color: var(--water); }
  .modal-input::placeholder { color: #4a5568; }
  .modal-btns { display: flex; gap: 10px; }
  .btn-cancel {
    flex: 1; padding: 12px; border-radius: 10px;
    background: var(--surface2); border: 1px solid var(--border);
    color: var(--text); font-family: 'Prompt', sans-serif;
    font-size: 14px; font-weight: 600; cursor: pointer;
    transition: background 0.15s;
  }
  .btn-cancel:hover { background: var(--border); }
  .btn-confirm {
    flex: 2; padding: 12px; border-radius: 10px;
    background: linear-gradient(135deg, #38bdf8, #0ea5e9);
    border: none; color: #fff; font-family: 'Prompt', sans-serif;
    font-size: 14px; font-weight: 600; cursor: pointer; opacity: 1;
    transition: opacity 0.15s;
  }
  .btn-confirm:hover { opacity: 0.88; }

  .success-box {
    text-align: center; max-width: 420px; width: 90%;
    background: var(--surface); border: 1px solid var(--success);
    border-radius: 24px; padding: 40px 32px;
    animation: popIn 0.35s cubic-bezier(0.34,1.56,0.64,1) both;
    max-height: 90vh; overflow-y: auto;
  }
  .success-icon {
    width: 64px; height: 64px;
    background: rgba(74,222,128,0.15); border: 2px solid var(--success);
    border-radius: 50%; display: flex; align-items: center; justify-content: center;
    font-size: 28px; margin: 0 auto 16px;
  }
  .success-box h2 { font-family: 'Prompt', sans-serif; font-size: 20px; color: var(--success); margin-bottom: 6px; }
  .success-box p { color: var(--muted); font-size: 14px; margin-bottom: 8px; }

  .receipt-info {
    background: var(--surface2); border-radius: 12px;
    padding: 14px; margin: 16px 0;
    text-align: left; font-size: 13px; line-height: 2;
  }
  .receipt-info .rkey { color: var(--muted); }
  .receipt-info .rval { font-weight: 600; float: right; }

  .btn-close-s {
    width: 100%; padding: 12px; background: var(--surface2);
    border: 1px solid var(--border); border-radius: 10px;
    color: var(--text); font-family: 'Prompt', sans-serif;
    font-size: 14px; font-weight: 600; cursor: pointer;
    transition: background 0.15s;
  }
  .btn-close-s:hover { background: var(--border); }

  /* Sidebar backdrop mobile */
  .sidebar-backdrop {
    display: none; position: fixed; inset: 0;
    background: rgba(0,0,0,0.5); z-index: 45;
  }

  @keyframes fadeDown { from { opacity:0; transform:translateY(-16px); } to { opacity:1; transform:translateY(0); } }
  @keyframes fadeUp   { from { opacity:0; transform:translateY(16px); }  to { opacity:1; transform:translateY(0); } }
  @keyframes popIn    { from { opacity:0; transform:scale(0.85); } to { opacity:1; transform:scale(1); } }

  @media (max-width: 640px) {
    .sidebar { transform: translateX(-100%); }
    .sidebar.mobile-open { transform: translateX(0); }
    .main { margin-left: 0 !important; }
    .topbar { left: 0 !important; }
    .form-grid { grid-template-columns: 1fr; }
    .form-grid .full { grid-column: 1; }
  }
</style>
</head>
<body>

<div class="sidebar-backdrop" id="sidebarBackdrop" onclick="closeMobileSidebar()"></div>

<!-- SIDEBAR -->
<aside class="sidebar" id="sidebar">
  <div class="sidebar-head">
    <div class="sidebar-logo">
      <div class="logo-icons">
        <span class="w">üíß</span>
        <span class="e">‚ö°</span>
      </div>
      ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏Å
    </div>
    <button class="sidebar-close-btn" onclick="toggleSidebar()" title="‡∏õ‡∏¥‡∏î‡πÄ‡∏°‡∏ô‡∏π">‚úï</button>
  </div>

  <button class="btn-add-room" onclick="openAddRoom()">
    <span style="font-size:20px;line-height:1">Ôºã</span> ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡πâ‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà
  </button>

  <div class="rooms-label">‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>

  <div class="rooms-list" id="roomsList">
    <div class="no-rooms" id="noRooms">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏Å<br>‡∏Å‡∏î "‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡πâ‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°</div>
  </div>
</aside>

<!-- TOPBAR -->
<div class="topbar" id="topbar">
  <button class="btn-menu" onclick="toggleSidebar()">‚ò∞</button>
  <span class="topbar-title">‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡πà‡∏≤‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏π‡∏õ‡πÇ‡∏†‡∏Ñ</span>
  <span class="topbar-room" id="topbarRoom" style="display:none"></span>
</div>

<!-- MAIN -->
<main class="main" id="main">
  <div class="content">

    <div class="empty-state" id="emptyState">
      <div class="empty-icon">üè†</div>
      <h2>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏Å</h2>
      <p>‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏°‡∏ô‡∏π‡∏ã‡πâ‡∏≤‡∏¢‡∏ö‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡πâ‡∏≠‡∏á<br>‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß</p>
      <button class="btn-empty" onclick="openAddRoom()">Ôºã ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡πâ‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà</button>
    </div>

    <div id="billForm" style="display:none">
      <div class="form-header">
        <div class="header-pill">
          <span>üè†</span>
          <span class="room-badge" id="formRoomBadge">‚Äî</span>
        </div>
        <h1>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡πà‡∏≤‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏π‡∏õ‡πÇ‡∏†‡∏Ñ</h1>
        <p>‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ô‡πâ‡∏≥‡πÅ‡∏•‡∏∞‡πÑ‡∏ü‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</p>
      </div>

      <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤ -->
      <div class="card">
        <div class="card-header">
          <div class="card-dot dot-water"></div>
          <span class="card-title">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤</span>
        </div>
        <div class="form-grid">
          <div class="form-group full">
            <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤</label>
            <input type="text" id="tenantName" placeholder="‡∏ä‡∏∑‡πà‡∏≠ - ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
          </div>
          <div class="form-group full">
            <label>‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô</label>
            <input type="text" id="tenantIdCard" placeholder="x-xxxx-xxxxx-xx-x" maxlength="17" oninput="formatIdCard(this)">
          </div>
          <div class="form-group">
            <label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
            <input type="tel" id="tenantPhone" placeholder="0xx-xxx-xxxx" maxlength="12" oninput="formatPhone(this)">
          </div>
          <div class="form-group">
            <label>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô / ‡∏õ‡∏µ (‡∏û.‡∏®.)</label>
            <div style="display:flex;gap:8px">
              <select id="billMonthSel" style="flex:1"></select>
              <select id="billYearSel" style="flex:1"></select>
            </div>
          </div>
          <div class="form-group full">
            <label>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</label>
            <input type="text" id="tenantAddress" placeholder="‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà ‡∏ñ‡∏ô‡∏ô ‡∏ï‡∏≥‡∏ö‡∏• ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î">
          </div>
        </div>
      </div>

      <!-- ‡∏Ñ‡πà‡∏≤‡∏´‡πâ‡∏≠‡∏á -->
      <div class="card">
        <div class="card-header">
          <div class="card-dot dot-rent"></div>
          <span class="card-title">üè† ‡∏Ñ‡πà‡∏≤‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏Å</span>
        </div>
        <div class="form-grid">
          <div class="form-group full">
            <label>‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (‡∏ö‡∏≤‡∏ó)</label>
            <input type="number" id="rentAmount" placeholder="0" oninput="updateSummary()">
          </div>
        </div>
        <div class="unit-display" style="margin-top:10px">
          <span class="unit-label">üè† ‡∏Ñ‡πà‡∏≤‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏Å</span>
          <span class="unit-val rent" id="rentDisplay">0.00 ‡∏ö‡∏≤‡∏ó</span>
        </div>
      </div>

      <!-- ‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥ -->
      <div class="card">
        <div class="card-header">
          <div class="card-dot dot-water"></div>
          <span class="card-title">üíß ‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥‡∏õ‡∏£‡∏∞‡∏õ‡∏≤</span>
        </div>
        <div class="form-grid">
          <div class="form-group">
            <label>‡πÄ‡∏•‡∏Ç‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</label>
            <input type="number" id="waterPrev" placeholder="0" oninput="calcWater()">
          </div>
          <div class="form-group">
            <label>‡πÄ‡∏•‡∏Ç‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</label>
            <input type="number" id="waterCurr" placeholder="0" oninput="calcWater()">
          </div>
          <div class="form-group full">
            <label>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢ (‡∏ö‡∏≤‡∏ó)</label>
            <input type="number" id="waterRate" value="18" oninput="calcWater()">
          </div>
        </div>
        <div class="unit-display">
          <span class="unit-label">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ</span>
          <span class="unit-val water" id="waterUnits">0 ‡∏´‡∏ô‡πà‡∏ß‡∏¢</span>
        </div>
        <div class="unit-display" style="margin-top:8px">
          <span class="unit-label">üíß ‡∏£‡∏ß‡∏°‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥</span>
          <span class="unit-val water" id="waterTotal">0.00 ‡∏ö‡∏≤‡∏ó</span>
        </div>
      </div>

      <!-- ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü -->
      <div class="card elec-focus">
        <div class="card-header">
          <div class="card-dot dot-elec"></div>
          <span class="card-title">‚ö° ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡∏ü‡πâ‡∏≤</span>
        </div>
        <div class="form-grid">
          <div class="form-group">
            <label>‡πÄ‡∏•‡∏Ç‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</label>
            <input type="number" id="elecPrev" placeholder="0" oninput="calcElec()">
          </div>
          <div class="form-group">
            <label>‡πÄ‡∏•‡∏Ç‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</label>
            <input type="number" id="elecCurr" placeholder="0" oninput="calcElec()">
          </div>
          <div class="form-group full">
            <label>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢ (‡∏ö‡∏≤‡∏ó)</label>
            <input type="number" id="elecRate" value="7" oninput="calcElec()">
          </div>
        </div>
        <div class="unit-display">
          <span class="unit-label">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ</span>
          <span class="unit-val elec" id="elecUnits">0 ‡∏´‡∏ô‡πà‡∏ß‡∏¢</span>
        </div>
        <div class="unit-display" style="margin-top:8px">
          <span class="unit-label">‚ö° ‡∏£‡∏ß‡∏°‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü</span>
          <span class="unit-val elec" id="elecTotal">0.00 ‡∏ö‡∏≤‡∏ó</span>
        </div>
      </div>

      <!-- ‡∏™‡∏£‡∏∏‡∏õ -->
      <div class="card">
        <div class="card-header">
          <div class="card-dot" style="background:#a78bfa;box-shadow:0 0 8px rgba(167,139,250,0.5)"></div>
          <span class="card-title">‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏ä‡∏≥‡∏£‡∏∞</span>
        </div>
        <div class="summary-row">
          <span class="slabel">üè† ‡∏Ñ‡πà‡∏≤‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏Å</span>
          <span class="val rent" id="sumRent">0.00 ‡∏ö‡∏≤‡∏ó</span>
        </div>
        <div class="summary-row">
          <span class="slabel">üíß ‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥‡∏õ‡∏£‡∏∞‡∏õ‡∏≤</span>
          <span class="val water" id="sumWater">0.00 ‡∏ö‡∏≤‡∏ó</span>
        </div>
        <div class="summary-row">
          <span class="slabel">‚ö° ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡∏ü‡πâ‡∏≤</span>
          <span class="val elec" id="sumElec">0.00 ‡∏ö‡∏≤‡∏ó</span>
        </div>
        <div class="total-row">
          <span class="total-label">üí∞ ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô</span>
          <span class="total-amount" id="grandTotal">0.00 ‡∏ö‡∏≤‡∏ó</span>
        </div>
        <button class="btn btn-primary" onclick="submitBill()">‚úÖ ‡∏™‡πà‡∏á‡∏ö‡∏¥‡∏•</button>
      </div>
    </div>

  </div>
</main>

<!-- MODAL: Add Room -->
<div class="overlay" id="addRoomOverlay">
  <div class="modal">
    <h2>üè† ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡πâ‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà</h2>
    <p>‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á ‡πÄ‡∏ä‡πà‡∏ô A1, B2, 101, 202</p>
    <input type="text" class="modal-input" id="newRoomInput" placeholder="‡πÄ‡∏ä‡πà‡∏ô A1, B2, 101 ..." maxlength="20"
      onkeydown="if(event.key==='Enter') confirmAddRoom()">
    <div class="modal-btns">
      <button class="btn-cancel" onclick="closeAddRoom()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
      <button class="btn-confirm" onclick="confirmAddRoom()">‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡πâ‡∏≠‡∏á</button>
    </div>
  </div>
</div>

<!-- MODAL: Success -->
<div class="overlay" id="successOverlay">
  <div class="success-box">
    <div class="success-icon">‚úÖ</div>
    <h2>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</h2>
    <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡∏Ñ‡πà‡∏≤‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏π‡∏õ‡πÇ‡∏†‡∏Ñ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß</p>
    <div class="receipt-info" id="receiptInfo"></div>
    <button class="btn-close-s" onclick="closeSuccess()">‡∏õ‡∏¥‡∏î / ‡∏£‡∏±‡∏ö‡∏ä‡∏≥‡∏£‡∏∞‡∏£‡∏≤‡∏¢‡πÉ‡∏´‡∏°‡πà</button>
  </div>
</div>

<script>
  // STATE
  let rooms = JSON.parse(localStorage.getItem('utl_rooms') || '[]');
  let activeRoomId = null;
  let sidebarVisible = true;

  // THAI MONTH DROPDOWNS INIT
  const THAI_MONTHS = ['‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°','‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå','‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°','‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô','‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°','‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô',
    '‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°','‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°','‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô','‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°','‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô','‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°'];

  (function initMonthYear() {
    const mSel = document.getElementById('billMonthSel');
    const ySel = document.getElementById('billYearSel');
    const now = new Date();
    THAI_MONTHS.forEach((m, i) => {
      const opt = document.createElement('option');
      opt.value = i + 1;
      opt.textContent = m;
      if (i === now.getMonth()) opt.selected = true;
      mSel.appendChild(opt);
    });
    for (let y = now.getFullYear() + 543; y >= now.getFullYear() + 543 - 5; y--) {
      const opt = document.createElement('option');
      opt.value = y;
      opt.textContent = '‡∏û.‡∏®. ' + y;
      if (y === now.getFullYear() + 543) opt.selected = true;
      ySel.appendChild(opt);
    }
  })();

  function getBillMonthLabel() {
    const m = parseInt(document.getElementById('billMonthSel').value);
    const y = document.getElementById('billYearSel').value;
    const short = ['‡∏°.‡∏Ñ.','‡∏Å.‡∏û.','‡∏°‡∏µ.‡∏Ñ.','‡πÄ‡∏°.‡∏¢.','‡∏û.‡∏Ñ.','‡∏°‡∏¥.‡∏¢.','‡∏Å.‡∏Ñ.','‡∏™.‡∏Ñ.','‡∏Å.‡∏¢.','‡∏ï.‡∏Ñ.','‡∏û.‡∏¢.','‡∏ò.‡∏Ñ.'];
    return `${short[m-1]} ${y}`;
  }

  // FORMAT helpers
  function formatIdCard(input) {
    let v = input.value.replace(/[^0-9]/g, '').substring(0, 13);
    let formatted = '';
    for (let i = 0; i < v.length; i++) {
      if (i === 1 || i === 5 || i === 10 || i === 12) formatted += '-';
      formatted += v[i];
    }
    input.value = formatted;
  }

  function formatPhone(input) {
    let v = input.value.replace(/[^0-9]/g, '').substring(0, 10);
    let formatted = '';
    for (let i = 0; i < v.length; i++) {
      if (i === 3 || i === 6) formatted += '-';
      formatted += v[i];
    }
    input.value = formatted;
  }

  // INIT
  renderRooms();
  initLayout();
  window.addEventListener('resize', initLayout);

  function initLayout() {
    if (window.innerWidth <= 640) {
      sidebarVisible = false;
      applySidebarState();
    } else {
      if (sidebarVisible === null) sidebarVisible = true;
      applySidebarState();
    }
  }

  function applySidebarState() {
    const sidebar = document.getElementById('sidebar');
    const main    = document.getElementById('main');
    const topbar  = document.getElementById('topbar');
    const backdrop = document.getElementById('sidebarBackdrop');

    if (window.innerWidth <= 640) {
      sidebar.classList.toggle('mobile-open', sidebarVisible);
      backdrop.style.display = sidebarVisible ? 'block' : 'none';
      main.classList.remove('expanded');
      topbar.classList.remove('expanded');
    } else {
      sidebar.classList.remove('mobile-open');
      backdrop.style.display = 'none';
      if (sidebarVisible) {
        sidebar.classList.remove('collapsed');
        main.classList.remove('expanded');
        topbar.classList.remove('expanded');
      } else {
        sidebar.classList.add('collapsed');
        main.classList.add('expanded');
        topbar.classList.add('expanded');
      }
    }
  }

  function toggleSidebar() {
    sidebarVisible = !sidebarVisible;
    applySidebarState();
  }

  function closeMobileSidebar() {
    sidebarVisible = false;
    applySidebarState();
  }

  // ROOMS
  function renderRooms() {
    const list = document.getElementById('roomsList');
    const noRooms = document.getElementById('noRooms');
    list.querySelectorAll('.room-item').forEach(el => el.remove());

    if (rooms.length === 0) { noRooms.style.display = 'block'; return; }
    noRooms.style.display = 'none';

    rooms.forEach(room => {
      const item = document.createElement('div');
      item.className = 'room-item' + (activeRoomId === room.id ? ' active' : '');
      item.innerHTML = `
        <div class="room-info">
          <span class="room-name">‡∏´‡πâ‡∏≠‡∏á ${escHtml(room.name)}</span>
          <span class="room-tenant">${escHtml(room.lastTenant || '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤')}</span>
        </div>
        <button class="room-delete" title="‡∏•‡∏ö‡∏´‡πâ‡∏≠‡∏á">üóë</button>
      `;
      item.querySelector('.room-delete').addEventListener('click', e => {
        e.stopPropagation();
        deleteRoom(room.id);
      });
      item.addEventListener('click', () => selectRoom(room.id));
      list.appendChild(item);
    });
  }

  function escHtml(str) {
    return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
  }

  function openAddRoom() {
    document.getElementById('newRoomInput').value = '';
    document.getElementById('addRoomOverlay').classList.add('show');
    setTimeout(() => document.getElementById('newRoomInput').focus(), 100);
  }

  function closeAddRoom() {
    document.getElementById('addRoomOverlay').classList.remove('show');
  }

  function confirmAddRoom() {
    const raw = document.getElementById('newRoomInput').value.trim();
    const name = raw.toUpperCase();
    if (!name) { document.getElementById('newRoomInput').focus(); return; }
    if (rooms.find(r => r.name === name)) { alert(`‡∏´‡πâ‡∏≠‡∏á ${name} ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß`); return; }
    const room = { id: Date.now().toString(), name, lastTenant: '', lastTenantFull: '', lastPhone: '', lastIdCard: '', lastAddress: '', lastRent: '' };
    rooms.push(room);
    saveRooms();
    renderRooms();
    closeAddRoom();
    selectRoom(room.id);
    if (window.innerWidth <= 640) { sidebarVisible = false; applySidebarState(); }
  }

  function deleteRoom(id) {
    const room = rooms.find(r => r.id === id);
    if (!room) return;
    if (!confirm(`‡∏•‡∏ö‡∏´‡πâ‡∏≠‡∏á ${room.name} ?\n‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡∏´‡∏≤‡∏¢‡∏ñ‡∏≤‡∏ß‡∏£`)) return;
    rooms = rooms.filter(r => r.id !== id);
    saveRooms();
    if (activeRoomId === id) { activeRoomId = null; showEmptyState(); }
    renderRooms();
  }

  function selectRoom(id) {
    activeRoomId = id;
    const room = rooms.find(r => r.id === id);
    document.getElementById('formRoomBadge').textContent = '‡∏´‡πâ‡∏≠‡∏á ' + room.name;
    document.getElementById('topbarRoom').textContent = '‡∏´‡πâ‡∏≠‡∏á ' + room.name;
    document.getElementById('topbarRoom').style.display = 'inline';
    document.getElementById('emptyState').style.display = 'none';
    document.getElementById('billForm').style.display = 'block';
    renderRooms();
    resetForm();
    // Prefill saved tenant info
    if (room.lastTenantFull) document.getElementById('tenantName').value = room.lastTenantFull;
    if (room.lastPhone)      document.getElementById('tenantPhone').value = room.lastPhone;
    if (room.lastIdCard)     document.getElementById('tenantIdCard').value = room.lastIdCard;
    if (room.lastAddress)    document.getElementById('tenantAddress').value = room.lastAddress;
    if (room.lastRent)       document.getElementById('rentAmount').value = room.lastRent;
    updateSummary();
  }

  function showEmptyState() {
    document.getElementById('emptyState').style.display = 'block';
    document.getElementById('billForm').style.display = 'none';
    document.getElementById('topbarRoom').style.display = 'none';
  }

  function saveRooms() { localStorage.setItem('utl_rooms', JSON.stringify(rooms)); }

  // CALC
  function getVal(id) { return parseFloat(document.getElementById(id).value) || 0; }

  function calcWater() {
    const units = Math.max(0, getVal('waterCurr') - getVal('waterPrev'));
    const total = units * getVal('waterRate');
    document.getElementById('waterUnits').textContent = `${units.toLocaleString()} ‡∏´‡∏ô‡πà‡∏ß‡∏¢`;
    document.getElementById('waterTotal').textContent = `${fmt(total)} ‡∏ö‡∏≤‡∏ó`;
    updateSummary();
  }

  function calcElec() {
    const units = Math.max(0, getVal('elecCurr') - getVal('elecPrev'));
    const total = units * getVal('elecRate');
    document.getElementById('elecUnits').textContent = `${units.toLocaleString()} ‡∏´‡∏ô‡πà‡∏ß‡∏¢`;
    document.getElementById('elecTotal').textContent = `${fmt(total)} ‡∏ö‡∏≤‡∏ó`;
    updateSummary();
  }

  function getRentTotal()  { return getVal('rentAmount'); }
  function getWaterTotal() { return Math.max(0, getVal('waterCurr') - getVal('waterPrev')) * getVal('waterRate'); }
  function getElecTotal()  { return Math.max(0, getVal('elecCurr') - getVal('elecPrev')) * getVal('elecRate'); }

  function updateSummary() {
    const r = getRentTotal(), w = getWaterTotal(), e = getElecTotal();
    document.getElementById('rentDisplay').textContent  = `${fmt(r)} ‡∏ö‡∏≤‡∏ó`;
    document.getElementById('sumRent').textContent      = `${fmt(r)} ‡∏ö‡∏≤‡∏ó`;
    document.getElementById('sumWater').textContent     = `${fmt(w)} ‡∏ö‡∏≤‡∏ó`;
    document.getElementById('sumElec').textContent      = `${fmt(e)} ‡∏ö‡∏≤‡∏ó`;
    document.getElementById('grandTotal').textContent   = `${fmt(r+w+e)} ‡∏ö‡∏≤‡∏ó`;
  }

  function fmt(n) { return n.toLocaleString('th-TH', { minimumFractionDigits: 2 }); }

  // SUBMIT
  function submitBill() {
    if (!activeRoomId) return;
    const room  = rooms.find(r => r.id === activeRoomId);
    const name  = document.getElementById('tenantName').value.trim();
    if (!name) { alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤‡∏Å‡πà‡∏≠‡∏ô'); return; }

    const monthLabel = getBillMonthLabel();
    const r = getRentTotal(), w = getWaterTotal(), e = getElecTotal(), g = r + w + e;
    const wU = Math.max(0, getVal('waterCurr') - getVal('waterPrev'));
    const eU = Math.max(0, getVal('elecCurr') - getVal('elecPrev'));
    const phone   = document.getElementById('tenantPhone').value.trim();
    const idCard  = document.getElementById('tenantIdCard').value.trim();
    const address = document.getElementById('tenantAddress').value.trim();
    const rent    = document.getElementById('rentAmount').value.trim();

    // Save back to room
    room.lastTenant = name;
    room.lastTenantFull = name;
    room.lastPhone   = phone;
    room.lastIdCard  = idCard;
    room.lastAddress = address;
    room.lastRent    = rent;
    saveRooms();
    renderRooms();

    document.getElementById('receiptInfo').innerHTML = `
      <div><span class="rkey">‡∏´‡πâ‡∏≠‡∏á</span><span class="rval">${escHtml(room.name)}</span><div style="clear:both"></div></div>
      <div><span class="rkey">‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤</span><span class="rval">${escHtml(name)}</span><div style="clear:both"></div></div>
      ${idCard ? `<div><span class="rkey">‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô</span><span class="rval">${escHtml(idCard)}</span><div style="clear:both"></div></div>` : ''}
      ${phone  ? `<div><span class="rkey">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£</span><span class="rval">${escHtml(phone)}</span><div style="clear:both"></div></div>` : ''}
      ${address? `<div><span class="rkey">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</span><span class="rval" style="max-width:200px;text-align:right;font-size:12px">${escHtml(address)}</span><div style="clear:both"></div></div>` : ''}
      <div><span class="rkey">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</span><span class="rval">${monthLabel}</span><div style="clear:both"></div></div>
      <div style="border-top:1px solid #30363d;margin-top:8px;padding-top:8px">
        <div><span class="rkey">üè† ‡∏Ñ‡πà‡∏≤‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏Å</span><span class="rval" style="color:var(--rent)">${fmt(r)} ‡∏ö‡∏≤‡∏ó</span><div style="clear:both"></div></div>
        <div><span class="rkey">üíß ‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥ (${wU} ‡∏´‡∏ô‡πà‡∏ß‡∏¢)</span><span class="rval" style="color:var(--water)">${fmt(w)} ‡∏ö‡∏≤‡∏ó</span><div style="clear:both"></div></div>
        <div><span class="rkey">‚ö° ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü (${eU} ‡∏´‡∏ô‡πà‡∏ß‡∏¢)</span><span class="rval" style="color:var(--electric)">${fmt(e)} ‡∏ö‡∏≤‡∏ó</span><div style="clear:both"></div></div>
      </div>
      <div style="border-top:1px solid #30363d;margin-top:8px;padding-top:8px">
        <span class="rkey"><b>‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô</b></span>
        <span class="rval" style="color:#4ade80;font-size:15px">${fmt(g)} ‡∏ö‡∏≤‡∏ó</span>
        <div style="clear:both"></div>
      </div>
    `;
    document.getElementById('successOverlay').classList.add('show');
  }

  function closeSuccess() {
    document.getElementById('successOverlay').classList.remove('show');
    resetForm();
  }

  function resetForm() {
    ['tenantName','tenantIdCard','tenantPhone','tenantAddress','rentAmount',
     'waterPrev','waterCurr','elecPrev','elecCurr']
      .forEach(id => document.getElementById(id).value = '');
    document.getElementById('waterRate').value = '18';
    document.getElementById('elecRate').value  = '7';
    const n = new Date();
    document.getElementById('billMonthSel').value = n.getMonth() + 1;
    document.getElementById('billYearSel').value  = n.getFullYear() + 543;
    calcWater(); calcElec(); updateSummary();
  }
</script>
</body>
</html>
